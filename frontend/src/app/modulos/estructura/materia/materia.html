<app-navbar></app-navbar>

<div class="main-container">
  <div class="content-wrapper">

    <!-- Breadcrumb -->
    <nav class="breadcrumb">
      <span>Dashboard</span>
      <span>/</span>
      <span>Estructura AcadÃ©mica</span>
      <span>/</span>
      <strong>Materias</strong>
    </nav>

    <!-- Header -->
    <div class="page-header">
      <h2>GestiÃ³n de Materias</h2>

      <button class="btn btn-primary" (click)="openCreate()">
        â• Nueva Materia
      </button>
    </div>

    <!-- Stats -->
    <div class="stats-grid">
      <div class="stat-card">
        <h3>Total</h3>
        <div class="stat-value">{{ materias.length }}</div>
      </div>

      <div class="stat-card">
        <h3>Activas</h3>
        <div class="stat-value">{{ materiasActivas }}</div>
      </div>

      <div class="stat-card">
        <h3>Inactivas</h3>
        <div class="stat-value">{{ materiasInactivas }}</div>
      </div>
    </div>

    <!-- Tabla -->
    <div class="table-container">
      <table class="table">
        <thead>
        <tr>
          <th>ID</th>
          <th>Carrera</th>
          <th>Materia</th>
          <th>Nivel</th>
          <th>Estado</th>
          <th>Acciones</th>
        </tr>
        </thead>

        <tbody>
        <tr *ngFor="let m of materiasFiltradas()">
          <td>#{{ m.id }}</td>

          <td>{{ m.carrera }}</td>

          <td>{{ m.nombre }}</td>

          <td>
            <span class="badge">{{ m.nivel }}</span>
          </td>

          <td>
              <span
                class="badge"
                [ngClass]="m.estado ? 'success' : 'danger'"
              >
                {{ m.estado ? 'Activa' : 'Inactiva' }}
              </span>
          </td>

          <td>
            <div class="action-buttons">

              <label class="toggle-switch">
                <input
                  type="checkbox"
                  [checked]="m.estado"
                  (change)="toggleEstado(m)"
                >
                <span class="toggle-slider"></span>
              </label>

              <button class="btn-icon" (click)="edit(m)">
                âœï¸
              </button>

            </div>
          </td>
        </tr>
        </tbody>
      </table>
    </div>

  </div>

  <app-footer></app-footer>
</div>

<!-- MODAL -->
<div class="modal" [class.active]="modalAbierto">

  <div class="modal-content">

    <div class="modal-header">
      <h3>{{ editando ? 'Editar Materia' : 'Nueva Materia' }}</h3>
      <button class="close-btn" (click)="closeModal()">Ã—</button>
    </div>

    <div class="modal-body">

      <div class="form-group">
        <label>Carrera *</label>
        <input
          class="form-input"
          [(ngModel)]="form.carrera"
          placeholder="Nombre de carrera"
        >
      </div>

      <div class="form-group">
        <label>Materia *</label>
        <input
          class="form-input"
          [(ngModel)]="form.nombre"
          placeholder="Nombre de materia"
        >
      </div>

      <div class="form-group">
        <label>Nivel *</label>
        <input
          type="number"
          class="form-input"
          [(ngModel)]="form.nivel"
          min="1"
          max="10"
        >
      </div>

      <div class="form-group">
        <label class="toggle-row">
          <input type="checkbox" [(ngModel)]="form.estado">
          Materia activa
        </label>
      </div>

    </div>

    <div class="modal-footer">
      <button class="btn btn-outline" (click)="closeModal()">
        Cancelar
      </button>

      <button class="btn btn-primary" (click)="guardar()">
        ğŸ’¾ Guardar
      </button>
    </div>

  </div>
</div>
